<!DOCTYPE html>
<html lang="en">
<head>
  <title>Student Success Predictor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-slate-950 bg-gradient-to-br from-slate-900 via-slate-950 to-sky-900 text-slate-100 flex items-center justify-center px-4 py-8">
  <div class="w-full max-w-4xl mx-auto grid gap-6 md:grid-cols-[minmax(0,1.4fr)_minmax(0,1fr)] items-start">
    <!-- Left: Form card -->
    <div class="bg-slate-900/70 border border-slate-700/80 rounded-2xl shadow-2xl shadow-sky-900/40 p-6 md:p-8 backdrop-blur">
      <div class="flex items-center gap-3 mb-4">
        <div class="h-10 w-10 rounded-xl bg-sky-500/10 border border-sky-500/40 flex items-center justify-center">
          <span class="text-sky-400 text-xl">üéì</span>
        </div>
        <div>
          <h1 class="text-xl md:text-2xl font-semibold tracking-tight">Student Success Predictor</h1>
          <p class="text-xs md:text-sm text-slate-400">
            Enter study behaviour and instantly estimate success probability for the next exam.
          </p>
        </div>
      </div>

      <form id="predict-form" class="space-y-4">
        <!-- Hours studied -->
        <div>
          <label for="hours_studied" class="flex items-center gap-2 text-xs font-medium text-slate-200 mb-1">
            Hours studied per day
            <span
              class="text-slate-400 text-[11px] border border-slate-600 rounded-full w-4 h-4 flex items-center justify-center cursor-help"
              title="Average hours the student studies on a typical day."
            >
              ?
            </span>
          </label>
          <p class="text-[11px] text-slate-500 mb-1">Range: 0‚Äì10 hours/day</p>
          <input
            id="hours_studied"
            type="number"
            step="0.1"
            min="0"
            max="10"
            value="3.5"
            required
            class="w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500"
          />
        </div>

        <!-- Attendance -->
        <div>
          <label for="attendance_rate" class="flex items-center gap-2 text-xs font-medium text-slate-200 mb-1">
            Attendance rate (0‚Äì1)
            <span
              class="text-slate-400 text-[11px] border border-slate-600 rounded-full w-4 h-4 flex items-center justify-center cursor-help"
              title="Percentage of classes attended, from 0 to 1. E.g. 0.9 = 90%."
            >
              ?
            </span>
          </label>
          <p class="text-[11px] text-slate-500 mb-1">Range: 0.0‚Äì1.0 (e.g. 0.85 = 85%)</p>
          <input
            id="attendance_rate"
            type="number"
            step="0.01"
            min="0"
            max="1"
            value="0.85"
            required
            class="w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500"
          />
        </div>

        <!-- Past grade avg -->
        <div>
          <label for="past_grade_avg" class="flex items-center gap-2 text-xs font-medium text-slate-200 mb-1">
            Past grade average (0‚Äì10)
            <span
              class="text-slate-400 text-[11px] border border-slate-600 rounded-full w-4 h-4 flex items-center justify-center cursor-help"
              title="Overall average of the student's past grades."
            >
              ?
            </span>
          </label>
          <p class="text-[11px] text-slate-500 mb-1">Range: 0‚Äì10</p>
          <input
            id="past_grade_avg"
            type="number"
            step="0.1"
            min="0"
            max="10"
            value="7.0"
            required
            class="w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500"
          />
        </div>

        <!-- Assignments completed -->
        <div>
          <label for="assignments_completed" class="flex items-center gap-2 text-xs font-medium text-slate-200 mb-1">
            Assignments completed
            <span
              class="text-slate-400 text-[11px] border border-slate-600 rounded-full w-4 h-4 flex items-center justify-center cursor-help"
              title="Number of assignments the student has completed."
            >
              ?
            </span>
          </label>
          <p class="text-[11px] text-slate-500 mb-1">Range: 0‚Äì20</p>
          <input
            id="assignments_completed"
            type="number"
            min="0"
            max="20"
            value="10"
            required
            class="w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500"
          />
        </div>

        <!-- Sleep hours -->
        <div>
          <label for="sleep_hours" class="flex items-center gap-2 text-xs font-medium text-slate-200 mb-1">
            Sleep hours per night
            <span
              class="text-slate-400 text-[11px] border border-slate-600 rounded-full w-4 h-4 flex items-center justify-center cursor-help"
              title="Average hours of sleep the student gets each night."
            >
              ?
            </span>
          </label>
          <p class="text-[11px] text-slate-500 mb-1">Range: 3‚Äì12 hours/night</p>
          <input
            id="sleep_hours"
            type="number"
            step="0.1"
            min="3"
            max="12"
            value="7"
            required
            class="w-full rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-sm text-slate-100 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500"
          />
        </div>

        <button
          id="submit-btn"
          type="submit"
          class="w-full inline-flex items-center justify-center gap-2 rounded-full bg-sky-500 hover:bg-sky-400 text-sm font-semibold py-2.5 text-slate-950 transition-colors disabled:opacity-70 disabled:cursor-wait"
        >
          <span id="btn-label">Predict</span>
          <span id="btn-spinner" class="hidden animate-spin h-4 w-4 border-2 border-slate-900 border-t-transparent rounded-full"></span>
        </button>
      </form>

      <div id="result" class="mt-4 hidden rounded-xl border text-sm px-3 py-3"></div>

      <div id="prob-bar-wrapper" class="mt-3 hidden">
        <div id="prob-label" class="text-[11px] text-slate-400 mb-1">
          Pass probability
        </div>
        <div class="w-full h-2 rounded-full bg-slate-800 overflow-hidden">
          <div
            id="prob-bar-fill"
            class="h-2 w-0 rounded-full bg-emerald-400 transition-all duration-300"
          ></div>
        </div>
      </div>

      <p class="mt-4 text-[11px] text-slate-500 text-center">
        Powered by FastAPI &amp; scikit-learn ‚Ä¢ Backend on Render ‚Ä¢ UI on GitHub Pages
      </p>
    </div>

    <!-- Right: Summary card -->
    <div class="space-y-4">
      <div class="bg-slate-900/70 border border-slate-700/80 rounded-2xl p-5 backdrop-blur">
        <h2 class="text-sm font-semibold text-slate-100 mb-2 flex items-center gap-2">
          How this prediction works
        </h2>
        <p class="text-xs text-slate-400 mb-2">
          The model uses a logistic regression pipeline trained on synthetic data to estimate how likely a student is to pass an exam.
        </p>
        <ul class="text-xs text-slate-400 space-y-1">
          <li>‚Ä¢ Higher study hours and attendance usually increase pass probability.</li>
          <li>‚Ä¢ Strong past grades are a positive signal.</li>
          <li>‚Ä¢ Too little sleep may negatively affect the prediction.</li>
        </ul>
      </div>

      <div class="bg-slate-900/70 border border-slate-700/80 rounded-2xl p-5 backdrop-blur">
        <h3 class="text-sm font-semibold text-slate-100 mb-2 flex items-center gap-2">
          Description
        </h3>
        <p class="text-xs text-slate-400 mb-2">
          This is a demo of an end-to-end ML microservice:
        </p>
        <ul class="text-xs text-slate-400 space-y-1 mb-2">
          <li>‚Ä¢ Model training in Python (scikit-learn)</li>
          <li>‚Ä¢ REST API with FastAPI</li>
          <li>‚Ä¢ Cloud deployment on Render</li>
          <li>‚Ä¢ Frontend served by GitHub Pages</li>
        </ul>
      </div>
    </div>
  </div>

  <script>
    const form = document.getElementById("predict-form");
    const resultDiv = document.getElementById("result");
    const submitBtn = document.getElementById("submit-btn");
    const btnLabel = document.getElementById("btn-label");
    const btnSpinner = document.getElementById("btn-spinner");
    const probWrapper = document.getElementById("prob-bar-wrapper");
    const probFill = document.getElementById("prob-bar-fill");
    const probLabel = document.getElementById("prob-label");

    // üî¥ IMPORTANT: replace this with your real Render URL (no trailing slash)
    const API_BASE = "https://student-success-api.onrender.com";

    function setLoading(isLoading) {
      if (isLoading) {
        submitBtn.disabled = true;
        btnLabel.textContent = "Predicting...";
        btnSpinner.classList.remove("hidden");
      } else {
        submitBtn.disabled = false;
        btnLabel.textContent = "Predict";
        btnSpinner.classList.add("hidden");
      }
    }

    form.addEventListener("submit", async (e) => {
      e.preventDefault();

      if (!form.reportValidity()) {
        return;
      }

      const payload = {
        hours_studied: parseFloat(document.getElementById("hours_studied").value),
        attendance_rate: parseFloat(document.getElementById("attendance_rate").value),
        past_grade_avg: parseFloat(document.getElementById("past_grade_avg").value),
        assignments_completed: parseInt(document.getElementById("assignments_completed").value, 10),
        sleep_hours: parseFloat(document.getElementById("sleep_hours").value),
      };

      resultDiv.className = "mt-4 rounded-xl border text-sm px-3 py-3 bg-sky-950/60 border-sky-700/70 text-sky-100";
      resultDiv.textContent =
        "‚è≥ Contacting the API... If this is the first request, the server might be waking up (5‚Äì20 seconds).";
      resultDiv.classList.remove("hidden");
      probWrapper.classList.add("hidden");
      setLoading(true);

      try {
        const response = await fetch(`${API_BASE}/predict`, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(payload),
        });

        if (!response.ok) {
          throw new Error(`Server returned ${response.status}`);
        }

        const data = await response.json();
        const prob = (data.pass_probability * 100).toFixed(1);

        probWrapper.classList.remove("hidden");
        probFill.style.width = `${prob}%`;

        if (data.prediction === 1) {
          resultDiv.className =
            "mt-4 rounded-xl border text-sm px-3 py-3 bg-emerald-950/60 border-emerald-600/70 text-emerald-100";
          resultDiv.innerHTML = `‚úÖ Likely to <strong>PASS</strong> the exam.<br /><span class="font-semibold">${prob}% probability</span>`;

          probFill.classList.remove("bg-red-500", "bg-orange-400", "bg-yellow-300");
          probFill.classList.add("bg-emerald-400");
          probLabel.textContent = "Pass probability (higher = better)";
        } else {
          resultDiv.className =
            "mt-4 rounded-xl border text-sm px-3 py-3 bg-red-950/60 border-red-600/70 text-red-100";
          resultDiv.innerHTML = `‚ö†Ô∏è At risk of <strong>FAILING</strong> the exam.<br /><span class="font-semibold">${prob}% probability of passing</span>`;

          probFill.classList.remove("bg-emerald-400");
          probFill.classList.add(prob <= 25 ? "bg-red-500" : prob <= 50 ? "bg-orange-400" : "bg-yellow-300");
          probLabel.textContent = "Pass probability (lower = higher risk)";
        }
      } catch (err) {
        console.error(err);
        resultDiv.className =
          "mt-4 rounded-xl border text-sm px-3 py-3 bg-red-950/60 border-red-600/70 text-red-100";
        resultDiv.textContent =
          "‚ùå Error contacting the API. Check your internet, API URL, or try again in a few seconds.";
        probWrapper.classList.add("hidden");
      } finally {
        setLoading(false);
      }
    });
  </script>
</body>
</html>
